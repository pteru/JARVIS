# Meeting Minutes Cron — GDrive Auto-Organizer

## Summary

Automated cron job that uses the Google Workspace MCP server to discover meeting minutes, recordings, and transcripts from Google Calendar/Drive, classify them by PMO project, organize them into the correct Drive folders, and optionally run AI analysis to extract action items, decisions, and follow-ups.

## Problem Statement

Meeting minutes and recordings accumulate in Google Drive (auto-generated by Google Meet, manually uploaded, or created as Google Docs). Currently:
1. No automated organization — files sit in "Meet Recordings" or personal Drive
2. No project association — minutes from a 03002 deployment review end up in the same place as a sales call
3. No extraction — action items, decisions, and deadlines are buried in transcripts
4. No alerts — if a meeting produces a deadline relevant to an active PMO project, nobody is notified

## Prerequisites

- Google Workspace MCP server (Done — 21 tools operational)
- Google Calendar API scope added to domain-wide delegation (NEW — `calendar.readonly` needed)
- `config/project-codes.json` with Drive folder mappings (Done — 22 projects configured)
- `/gdrive` skill for manual organization (Done)

## Architecture

### Data Flow

```
┌─────────────────────────────────────────────────────────────────┐
│ Cron (every 30 min or configurable)                             │
│                                                                 │
│  1. Google Calendar API                                         │
│     → Fetch recent events (last 24h) with attendees + links     │
│     → Extract Meet recording links, attached Docs               │
│                                                                 │
│  2. Google Drive scan                                           │
│     → Scan "Meet Recordings" folder for new files               │
│     → Scan configured project folders for unclassified minutes  │
│                                                                 │
│  3. Classify                                                    │
│     → Match meeting title/attendees/content → PMO project code  │
│     → Use project-codes.json keywords, attendee email domains   │
│     → AI fallback for ambiguous matches (claude --print)        │
│                                                                 │
│  4. Organize                                                    │
│     → move_file to project's Drive folder (meetings/ subfolder) │
│     → Rename with date prefix: YYYY-MM-DD - Meeting Title       │
│                                                                 │
│  5. Analyze (optional, configurable per project)                │
│     → Download transcript/Doc content                           │
│     → claude --print: extract action items, decisions, dates    │
│     → Create summary Google Doc in project folder               │
│     → Alert via Telegram if deadlines < 7 days                  │
│                                                                 │
│  6. Log                                                         │
│     → Write to data/meeting-minutes/processing-log.json         │
│     → Update drive-index.json for affected projects             │
└─────────────────────────────────────────────────────────────────┘
```

### Classification Rules

```json
{
  "rules": [
    {
      "type": "title_keyword",
      "keywords": ["03002", "visionking", "sis surface", "laminacao"],
      "project": "03002"
    },
    {
      "type": "attendee_domain",
      "domain": "arcelormittal.com.br",
      "projects": ["03001", "03002"]
    },
    {
      "type": "attendee_email",
      "email": "contact@supplier.com",
      "project": "01005"
    },
    {
      "type": "folder_context",
      "parent_folder_id": "1aBcDe...",
      "project": "02003"
    }
  ],
  "fallback": "ai_classify",
  "unclassified_folder": "meetings/unclassified"
}
```

### Config Extension

Add to `config/project-codes.json` per project:

```json
{
  "meetings": {
    "enabled": true,
    "auto_analyze": true,
    "keywords": ["project name", "client name", "deployment code"],
    "attendee_domains": ["client.com"],
    "drive_subfolder": "meetings",
    "alert_deadlines": true
  }
}
```

### Script Structure

```
scripts/meeting-minutes/
├── scan.sh              # Main cron entry point
├── lib/
│   ├── calendar.sh      # Google Calendar API queries (via MCP tools)
│   ├── classify.sh      # Rule-based + AI classification
│   ├── organize.sh      # Drive move/rename operations
│   └── analyze.sh       # AI analysis pipeline (claude --print)
├── config/
│   └── classify-rules.json
└── templates/
    └── analysis-prompt.md   # Prompt template for meeting analysis
```

## Complexity Analysis

| Aspect | Rating | Notes |
|--------|--------|-------|
| **Scope** | Medium | Calendar API is new; Drive tools already exist |
| **Risk** | Low-Medium | Misclassification moves files to wrong folders (reversible) |
| **Dependencies** | Google Calendar API scope | Need to add `calendar.readonly` to domain-wide delegation |
| **Testing** | Medium | Need test meetings and sample transcripts |
| **Maintenance** | Low | Classification rules need periodic updates for new projects |

**Overall Complexity: Medium**

## New Scope Required

**Google Admin Console change:**
- Add `https://www.googleapis.com/auth/calendar.readonly` to the service account's domain-wide delegation scopes
- This is a one-time admin action

**Google Workspace MCP server extension (2 new tools):**
- `list_calendar_events` — Fetch events in a time range with attendees, Meet links, attachments
- `get_calendar_event` — Get single event details including transcript/recording links

## Development Phases

### Phase 1 — Calendar API Integration
**Estimate: 3-4 hours**

1. Add `calendar.readonly` scope to GCP domain-wide delegation
2. Add 2 Calendar tools to `mcp-servers/google-workspace/index.js`
3. Test: fetch recent meetings, extract Meet recording links
4. Verify service account impersonation works for Calendar

### Phase 2 — Classification Engine
**Estimate: 3-4 hours**

1. Create `config/meeting-classify-rules.json` with rules per project
2. Extend `config/project-codes.json` with `meetings` config section
3. Implement rule-based classifier (title keywords → attendee domains → folder context)
4. Implement AI fallback: pipe meeting title + attendees to `claude --print` for classification
5. Write `scripts/meeting-minutes/classify.sh`

### Phase 3 — Organizer Cron
**Estimate: 2-3 hours**

1. Write `scripts/meeting-minutes/scan.sh` — main cron entry point
2. Implement Drive scanning for "Meet Recordings" folder + unclassified files
3. Implement `organize.sh` — move + rename with date prefix
4. Add cron entry (every 30 min or configurable)
5. Add dispatch logging to `dispatches.json`
6. Test end-to-end: create test meeting → verify file appears in correct project folder

### Phase 4 — AI Analysis (Optional)
**Estimate: 2-3 hours**

1. Create `templates/analysis-prompt.md` for meeting transcript analysis
2. Implement `analyze.sh` — download transcript, pipe to `claude --print`, create summary Doc
3. Extract structured data: action items (who, what, when), decisions, follow-ups
4. Create summary Google Doc in project's meetings subfolder
5. Telegram alert for deadlines within 7 days
6. Configurable per project (`auto_analyze: true/false`)

## Estimates Summary

| Phase | Hours | Dependencies |
|-------|-------|-------------|
| Phase 1 — Calendar API | 3-4h | Admin Console access |
| Phase 2 — Classification | 3-4h | Phase 1 |
| Phase 3 — Organizer cron | 2-3h | Phase 2 |
| Phase 4 — AI analysis | 2-3h | Phase 3 (optional) |
| **Total** | **10-14h** | |

## References

- Google Calendar API: https://developers.google.com/calendar/api
- Existing MCP server: `mcp-servers/google-workspace/index.js` (1,877 lines, 21 tools)
- Meeting Assistant spec: `backlogs/orchestrator/meeting-assistant.md` (broader scope — real-time transcription)
- This feature is a subset of Meeting Assistant, focused on post-meeting organization only
